from _helpers import *


#[360.000000 nm, 830.000000 nm] (1.000000 nm)
_cie_xbar_2deg_data = [ 1.230072e-08, 1.381081e-08, 1.551104e-08, 1.742401e-08, 1.957228e-08, 2.197843e-08, 2.468933e-08, 2.775239e-08, 3.119100e-08, 3.502856e-08, 3.928846e-08, 4.395295e-08, 4.914476e-08, 5.509797e-08, 6.204667e-08, 7.022492e-08, 8.001907e-08, 9.133471e-08, 1.036849e-07, 1.165827e-07, 1.295411e-07, 1.422348e-07, 1.555183e-07, 1.706744e-07, 1.889858e-07, 2.117353e-07, 2.400852e-07, 2.739116e-07, 3.125681e-07, 3.554082e-07, 4.017858e-07, 4.509687e-07, 5.047225e-07, 5.661470e-07, 6.383420e-07, 7.244076e-07, 8.287008e-07, 9.496728e-07, 1.081564e-06, 1.218615e-06, 1.355068e-06, 1.487112e-06, 1.623756e-06, 1.778465e-06, 1.964708e-06, 2.195949e-06, 2.481675e-06, 2.820216e-06, 3.208313e-06, 3.642704e-06, 4.120127e-06, 4.639580e-06, 5.210299e-06, 5.844388e-06, 6.553947e-06, 7.351080e-06, 8.234394e-06, 9.202033e-06, 1.026540e-05, 1.143591e-05, 1.272495e-05, 1.414330e-05, 1.566195e-05, 1.723267e-05, 1.880723e-05, 2.033739e-05, 2.179726e-05, 2.318859e-05, 2.450461e-05, 2.573852e-05, 2.688357e-05, 2.792935e-05, 2.887181e-05, 2.971371e-05, 3.045783e-05, 3.110691e-05, 3.166100e-05, 3.212109e-05, 3.249146e-05, 3.277633e-05, 3.297996e-05, 3.310494e-05, 3.315679e-05, 3.314406e-05, 3.307531e-05, 3.295912e-05, 3.279940e-05, 3.259952e-05, 3.236718e-05, 3.211011e-05, 3.183606e-05, 3.155176e-05, 3.125285e-05, 3.093038e-05, 3.057538e-05, 3.017891e-05, 2.973623e-05, 2.924940e-05, 2.871972e-05, 2.814848e-05, 2.753696e-05, 2.689021e-05, 2.620380e-05, 2.546485e-05, 2.466042e-05, 2.377761e-05, 2.280677e-05, 2.176548e-05, 2.068181e-05, 1.958377e-05, 1.849938e-05, 1.744389e-05, 1.641302e-05, 1.540555e-05, 1.442028e-05, 1.345599e-05, 1.251649e-05, 1.160658e-05, 1.072646e-05, 9.876365e-06, 9.056515e-06, 8.266726e-06, 7.509980e-06, 6.791227e-06, 6.115420e-06, 5.487507e-06, 4.911020e-06, 4.382573e-06, 3.896733e-06, 3.448069e-06, 3.031149e-06, 2.643586e-06, 2.286325e-06, 1.958931e-06, 1.660967e-06, 1.391999e-06, 1.151646e-06, 9.393587e-07, 7.544483e-07, 5.962249e-07, 4.639996e-07, 3.576749e-07, 2.789036e-07, 2.296211e-07, 2.117631e-07, 2.272651e-07, 2.770286e-07, 3.632985e-07, 4.900253e-07, 6.611597e-07, 8.806524e-07, 1.150481e-06, 1.471152e-06, 1.844400e-06, 2.271967e-06, 2.755590e-06, 3.296751e-06, 3.893824e-06, 4.543886e-06, 5.244011e-06, 5.991277e-06, 6.783392e-06, 7.619275e-06, 8.497818e-06, 9.417909e-06, 1.037844e-05, 1.137911e-05, 1.241573e-05, 1.348136e-05, 1.456904e-05, 1.567182e-05, 1.678515e-05, 1.791039e-05, 1.904950e-05, 2.020442e-05, 2.137712e-05, 2.256751e-05, 2.377447e-05, 2.499843e-05, 2.623981e-05, 2.749908e-05, 2.877661e-05, 3.007216e-05, 3.138516e-05, 3.271508e-05, 3.406136e-05, 3.542343e-05, 3.680176e-05, 3.819743e-05, 3.961151e-05, 4.104502e-05, 4.249813e-05, 4.396974e-05, 4.545909e-05, 4.696541e-05, 4.848797e-05, 5.002635e-05, 5.157892e-05, 5.314305e-05, 5.471612e-05, 5.629547e-05, 5.787883e-05, 5.946542e-05, 6.105480e-05, 6.264655e-05, 6.424028e-05, 6.583484e-05, 6.742754e-05, 6.901553e-05, 7.059601e-05, 7.216615e-05, 7.372322e-05, 7.526506e-05, 7.678970e-05, 7.829518e-05, 7.977953e-05, 8.124089e-05, 8.267542e-05, 8.407810e-05, 8.544393e-05, 8.676793e-05, 8.804625e-05, 8.927717e-05, 9.045887e-05, 9.158954e-05, 9.266736e-05, 9.368868e-05, 9.465108e-05, 9.555449e-05, 9.639890e-05, 9.718425e-05, 9.791175e-05, 9.857492e-05, 9.916221e-05, 9.966207e-05, 1.000629e-04, 1.003560e-04, 1.005458e-04, 1.006412e-04, 1.006510e-04, 1.005838e-04, 1.004450e-04, 1.002280e-04, 9.992321e-05, 9.952099e-05, 9.901184e-05, 9.839036e-05, 9.766348e-05, 9.684015e-05, 9.592934e-05, 9.494001e-05, 9.387636e-05, 9.273661e-05, 9.152076e-05, 9.022879e-05, 8.886066e-05, 8.742075e-05, 8.591038e-05, 8.432502e-05, 8.266011e-05, 8.091111e-05, 7.907728e-05, 7.717034e-05, 7.520449e-05, 7.319395e-05, 7.115292e-05, 6.908705e-05, 6.700427e-05, 6.492228e-05, 6.285873e-05, 6.083130e-05, 5.885361e-05, 5.692175e-05, 5.502706e-05, 5.316088e-05, 5.131457e-05, 4.948693e-05, 4.768272e-05, 4.590221e-05, 4.414567e-05, 4.241335e-05, 4.070520e-05, 3.902313e-05, 3.737034e-05, 3.575006e-05, 3.416552e-05, 3.261788e-05, 3.110851e-05, 2.964098e-05, 2.821886e-05, 2.684569e-05, 2.552422e-05, 2.425283e-05, 2.302855e-05, 2.184844e-05, 2.070953e-05, 1.961081e-05, 1.855271e-05, 1.753453e-05, 1.655554e-05, 1.561501e-05, 1.471226e-05, 1.384707e-05, 1.301945e-05, 1.222939e-05, 1.147689e-05, 1.076098e-05, 1.008158e-05, 9.440067e-06, 8.837830e-06, 8.276238e-06, 7.755513e-06, 7.272889e-06, 6.825257e-06, 6.409505e-06, 6.022526e-06, 5.663338e-06, 5.329572e-06, 5.016029e-06, 4.717514e-06, 4.428829e-06, 4.146078e-06, 3.870643e-06, 3.605243e-06, 3.352597e-06, 3.115426e-06, 2.894239e-06, 2.687463e-06, 2.494693e-06, 2.315524e-06, 2.149549e-06, 1.996552e-06, 1.855987e-06, 1.726961e-06, 1.608580e-06, 1.499950e-06, 1.400582e-06, 1.309740e-06, 1.226160e-06, 1.148560e-06, 1.075642e-06, 1.006534e-06, 9.411471e-07, 8.795560e-07, 8.218337e-07, 7.680535e-07, 7.180052e-07, 6.712603e-07, 6.275655e-07, 5.866667e-07, 5.483099e-07, 5.122770e-07, 4.784483e-07, 4.467192e-07, 4.169848e-07, 3.891401e-07, 3.630478e-07, 3.386012e-07, 3.157415e-07, 2.944101e-07, 2.745483e-07, 2.560850e-07, 2.389144e-07, 2.229251e-07, 2.080059e-07, 1.940456e-07, 1.809561e-07, 1.686911e-07, 1.572021e-07, 1.464401e-07, 1.363563e-07, 1.268937e-07, 1.180145e-07, 1.097000e-07, 1.019313e-07, 9.468900e-08, 8.794552e-08, 8.166708e-08, 7.582609e-08, 7.039499e-08, 6.534617e-08, 6.065286e-08, 5.629566e-08, 5.225816e-08, 4.852385e-08, 4.507627e-08, 4.189761e-08, 3.896761e-08, 3.626597e-08, 3.377246e-08, 3.146685e-08, 2.933222e-08, 2.735582e-08, 2.552371e-08, 2.382195e-08, 2.223658e-08, 2.075414e-08, 1.936733e-08, 1.807141e-08, 1.686169e-08, 1.573342e-08, 1.467977e-08, 1.369480e-08, 1.277512e-08, 1.191740e-08, 1.111828e-08, 1.037385e-08, 9.680027e-09, 9.033263e-09, 8.430012e-09, 7.866713e-09, 7.339971e-09, 6.847593e-09, 6.387834e-09, 5.958933e-09, 5.559144e-09, 5.186406e-09, 4.838776e-09, 4.514673e-09, 4.212517e-09, 3.930734e-09, 3.667798e-09, 3.422423e-09, 3.193408e-09, 2.979528e-09, 2.779572e-09, 2.592312e-09, 2.416996e-09, 2.253122e-09, 2.100185e-09, 1.957684e-09, 1.824964e-09, 1.701307e-09, 1.586113e-09, 1.478784e-09, 1.378720e-09, 1.285361e-09, 1.198289e-09, 1.117125e-09, 1.041484e-09, 9.709903e-10, 9.052392e-10, 8.439112e-10, 7.867500e-10, 7.334763e-10, 6.838271e-10, 6.375237e-10, 5.943384e-10, 5.540822e-10, 5.165659e-10, 4.816002e-10, 4.489874e-10, 4.185690e-10, 3.902126e-10, 3.637867e-10, 3.391602e-10, 3.161946e-10, 2.947770e-10, 2.748129e-10, 2.562078e-10, 2.388675e-10, 2.226939e-10, 2.076081e-10, 1.935449e-10, 1.804388e-10, 1.682244e-10, 1.568333e-10, 1.462072e-10, 1.363060e-10, 1.270791e-10, 1.184753e-10 ]
_cie_ybar_2deg_data = [ 3.709977e-10, 4.161370e-10, 4.669062e-10, 5.239749e-10, 5.880124e-10, 6.596883e-10, 7.400271e-10, 8.303961e-10, 9.319784e-10, 1.045957e-09, 1.173516e-09, 1.315248e-09, 1.473504e-09, 1.652109e-09, 1.854870e-09, 2.085619e-09, 2.352681e-09, 2.655921e-09, 2.986451e-09, 3.335400e-09, 3.693876e-09, 4.056292e-09, 4.443505e-09, 4.886296e-09, 5.415449e-09, 6.061744e-09, 6.852064e-09, 7.786712e-09, 8.856603e-09, 1.005265e-08, 1.136577e-08, 1.278498e-08, 1.434853e-08, 1.612121e-08, 1.816781e-08, 2.055310e-08, 2.338571e-08, 2.663758e-08, 3.016854e-08, 3.383843e-08, 3.750704e-08, 4.107918e-08, 4.480235e-08, 4.905050e-08, 5.419755e-08, 6.061744e-08, 6.862652e-08, 7.818703e-08, 8.914174e-08, 1.013334e-07, 1.146049e-07, 1.290101e-07, 1.449848e-07, 1.629442e-07, 1.833036e-07, 2.064782e-07, 2.325058e-07, 2.617916e-07, 2.953017e-07, 3.340021e-07, 3.788590e-07, 4.305960e-07, 4.886637e-07, 5.521188e-07, 6.200179e-07, 6.914177e-07, 7.659115e-07, 8.437872e-07, 9.251434e-07, 1.010079e-06, 1.098691e-06, 1.190865e-06, 1.286484e-06, 1.385647e-06, 1.488451e-06, 1.594996e-06, 1.705563e-06, 1.819895e-06, 1.937288e-06, 2.057038e-06, 2.178439e-06, 2.301058e-06, 2.425668e-06, 2.553374e-06, 2.685282e-06, 2.822500e-06, 2.965598e-06, 3.114570e-06, 3.269659e-06, 3.431109e-06, 3.599161e-06, 3.774068e-06, 3.956046e-06, 4.145286e-06, 4.341977e-06, 4.546308e-06, 4.758818e-06, 4.979443e-06, 5.207470e-06, 5.442189e-06, 5.682885e-06, 5.929330e-06, 6.182744e-06, 6.444589e-06, 6.716327e-06, 6.999420e-06, 7.294552e-06, 7.602413e-06, 7.924481e-06, 8.262233e-06, 8.617149e-06, 8.990093e-06, 9.381103e-06, 9.790418e-06, 1.021826e-05, 1.066488e-05, 1.113201e-05, 1.161908e-05, 1.212281e-05, 1.263995e-05, 1.316725e-05, 1.370299e-05, 1.425166e-05, 1.481925e-05, 1.541177e-05, 1.603521e-05, 1.669282e-05, 1.738566e-05, 1.811642e-05, 1.888783e-05, 1.970256e-05, 2.056446e-05, 2.147510e-05, 2.243386e-05, 2.344012e-05, 2.449324e-05, 2.559050e-05, 2.673740e-05, 2.794564e-05, 2.922689e-05, 3.059287e-05, 3.205167e-05, 3.359398e-05, 3.520534e-05, 3.687127e-05, 3.857732e-05, 4.031343e-05, 4.208268e-05, 4.389029e-05, 4.574150e-05, 4.764152e-05, 4.958974e-05, 5.157332e-05, 5.357919e-05, 5.559428e-05, 5.760551e-05, 5.960832e-05, 6.159365e-05, 6.354178e-05, 6.543297e-05, 6.724748e-05, 6.896988e-05, 7.060640e-05, 7.216975e-05, 7.367262e-05, 7.512774e-05, 7.653998e-05, 7.790253e-05, 7.921059e-05, 8.045939e-05, 8.164412e-05, 8.276278e-05, 8.381900e-05, 8.481646e-05, 8.575883e-05, 8.664980e-05, 8.749132e-05, 8.828290e-05, 8.902454e-05, 8.971620e-05, 9.035788e-05, 9.095042e-05, 9.149516e-05, 9.199271e-05, 9.244373e-05, 9.284888e-05, 9.320807e-05, 9.352307e-05, 9.379724e-05, 9.403391e-05, 9.423646e-05, 9.440322e-05, 9.453464e-05, 9.463065e-05, 9.469091e-05, 9.471476e-05, 9.470118e-05, 9.464889e-05, 9.455616e-05, 9.442102e-05, 9.424118e-05, 9.401391e-05, 9.374323e-05, 9.343084e-05, 9.307847e-05, 9.268786e-05, 9.226010e-05, 9.179481e-05, 9.129146e-05, 9.074951e-05, 9.016845e-05, 8.954810e-05, 8.888972e-05, 8.819486e-05, 8.746506e-05, 8.670189e-05, 8.590689e-05, 8.508011e-05, 8.422082e-05, 8.332830e-05, 8.240184e-05, 8.144155e-05, 8.044996e-05, 7.942988e-05, 7.838416e-05, 7.731566e-05, 7.622593e-05, 7.511657e-05, 7.399041e-05, 7.285030e-05, 7.169907e-05, 7.053920e-05, 6.937121e-05, 6.819497e-05, 6.701036e-05, 6.581728e-05, 6.461623e-05, 6.340884e-05, 6.219676e-05, 6.098160e-05, 5.976501e-05, 5.854845e-05, 5.733221e-05, 5.611618e-05, 5.490026e-05, 5.368432e-05, 5.246829e-05, 5.125368e-05, 5.004281e-05, 4.883799e-05, 4.764152e-05, 4.645463e-05, 4.527653e-05, 4.410654e-05, 4.294397e-05, 4.178815e-05, 4.064021e-05, 3.949946e-05, 3.836251e-05, 3.722593e-05, 3.608632e-05, 3.494202e-05, 3.379680e-05, 3.265545e-05, 3.152274e-05, 3.040344e-05, 2.929888e-05, 2.821083e-05, 2.714464e-05, 2.610571e-05, 2.509941e-05, 2.412983e-05, 2.319466e-05, 2.228964e-05, 2.141054e-05, 2.055310e-05, 1.971598e-05, 1.890022e-05, 1.810522e-05, 1.733038e-05, 1.657508e-05, 1.583853e-05, 1.512087e-05, 1.442294e-05, 1.374556e-05, 1.308958e-05, 1.245502e-05, 1.184169e-05, 1.125014e-05, 1.068090e-05, 1.013448e-05, 9.611294e-06, 9.110484e-06, 8.630689e-06, 8.170554e-06, 7.728724e-06, 7.304463e-06, 6.897651e-06, 6.507858e-06, 6.134652e-06, 5.777600e-06, 5.436268e-06, 5.110338e-06, 4.799553e-06, 4.503654e-06, 4.222384e-06, 3.955167e-06, 3.701922e-06, 3.463135e-06, 3.239290e-06, 3.030872e-06, 2.837901e-06, 2.659272e-06, 2.493779e-06, 2.340217e-06, 2.197382e-06, 2.064855e-06, 1.941759e-06, 1.826203e-06, 1.716297e-06, 1.610151e-06, 1.506324e-06, 1.405300e-06, 1.308075e-06, 1.215643e-06, 1.129000e-06, 1.048332e-06, 9.730416e-07, 9.029452e-07, 8.378616e-07, 7.776082e-07, 7.220846e-07, 6.710942e-07, 6.243100e-07, 5.814051e-07, 5.420526e-07, 5.060665e-07, 4.731756e-07, 4.429245e-07, 4.148577e-07, 3.885199e-07, 3.635581e-07, 3.399406e-07, 3.176940e-07, 2.968449e-07, 2.774195e-07, 2.593422e-07, 2.424580e-07, 2.266755e-07, 2.119030e-07, 1.980486e-07, 1.850335e-07, 1.728147e-07, 1.613542e-07, 1.506142e-07, 1.405567e-07, 1.311322e-07, 1.223021e-07, 1.140453e-07, 1.063404e-07, 9.916635e-08, 9.249745e-08, 8.629545e-08, 8.052016e-08, 7.513138e-08, 7.008892e-08, 6.536101e-08, 6.093095e-08, 5.678112e-08, 5.289390e-08, 4.925167e-08, 4.583376e-08, 4.262664e-08, 3.962346e-08, 3.681737e-08, 3.420150e-08, 3.176577e-08, 2.949800e-08, 2.738825e-08, 2.542655e-08, 2.360292e-08, 2.190770e-08, 2.033389e-08, 1.887555e-08, 1.752673e-08, 1.628147e-08, 1.513334e-08, 1.407503e-08, 1.309920e-08, 1.219855e-08, 1.136577e-08, 1.059475e-08, 9.880871e-09, 9.219118e-09, 8.604444e-09, 8.031811e-09, 7.496358e-09, 6.995442e-09, 6.527362e-09, 6.090412e-09, 5.682885e-09, 5.302309e-09, 4.946535e-09, 4.614351e-09, 4.304546e-09, 4.015906e-09, 3.747010e-09, 3.496407e-09, 3.262798e-09, 3.044905e-09, 2.841443e-09, 2.651184e-09, 2.473339e-09, 2.307274e-09, 2.152356e-09, 2.007953e-09, 1.873321e-09, 1.747757e-09, 1.630692e-09, 1.521554e-09, 1.419774e-09, 1.324802e-09, 1.236174e-09, 1.153453e-09, 1.076200e-09, 1.003976e-09, 9.363384e-10, 8.730147e-10, 8.138235e-10, 7.585831e-10, 7.071120e-10, 6.591737e-10, 6.145093e-10, 5.729011e-10, 5.341340e-10, 4.979912e-10, 4.642700e-10, 4.328199e-10, 4.035032e-10, 3.761823e-10, 3.507193e-10, 3.269708e-10, 3.048207e-10, 2.841727e-10, 2.649303e-10, 2.469971e-10, 2.302724e-10, 2.146739e-10, 2.001323e-10, 1.865827e-10, 1.739531e-10, 1.621734e-10, 1.511863e-10, 1.409441e-10, 1.313991e-10, 1.225041e-10, 1.142089e-10, 1.064729e-10, 9.926106e-11, 9.254179e-11, 8.627851e-11, 8.043663e-11, 7.498768e-11, 6.990805e-11, 6.517415e-11, 6.076236e-11, 5.664790e-11, 5.281054e-11, 4.923349e-11, 4.589994e-11, 4.279307e-11 ]
#[360.000000 nm, 649.000000 nm] (1.000000 nm)
_cie_zbar_2deg_data = [ 5.743051e-08, 6.451616e-08, 7.250075e-08, 8.148978e-08, 9.158871e-08, 1.029030e-07, 1.156556e-07, 1.300718e-07, 1.462606e-07, 1.643309e-07, 1.843916e-07, 2.063535e-07, 2.308031e-07, 2.588640e-07, 2.916595e-07, 3.303131e-07, 3.766694e-07, 4.302674e-07, 4.887724e-07, 5.498497e-07, 6.111646e-07, 6.711644e-07, 7.339174e-07, 8.055197e-07, 8.920675e-07, 9.996557e-07, 1.133810e-06, 1.293951e-06, 1.477033e-06, 1.680006e-06, 1.899822e-06, 2.133046e-06, 2.388078e-06, 2.679622e-06, 3.022378e-06, 3.431049e-06, 3.926397e-06, 4.501176e-06, 5.128085e-06, 5.779819e-06, 6.429073e-06, 7.057891e-06, 7.709348e-06, 8.447681e-06, 9.337123e-06, 1.044191e-05, 1.180763e-05, 1.342683e-05, 1.528418e-05, 1.736435e-05, 1.965202e-05, 2.214330e-05, 2.488353e-05, 2.793113e-05, 3.134454e-05, 3.518223e-05, 3.943755e-05, 4.410468e-05, 4.924326e-05, 5.491292e-05, 6.117330e-05, 6.807935e-05, 7.549192e-05, 8.317957e-05, 9.091086e-05, 9.845435e-05, 1.056857e-04, 1.126151e-04, 1.192125e-04, 1.254479e-04, 1.312914e-04, 1.366957e-04, 1.416389e-04, 1.461290e-04, 1.501741e-04, 1.537823e-04, 1.569513e-04, 1.596888e-04, 1.620178e-04, 1.639609e-04, 1.655412e-04, 1.667716e-04, 1.676792e-04, 1.683084e-04, 1.687035e-04, 1.689088e-04, 1.689437e-04, 1.688235e-04, 1.685865e-04, 1.682708e-04, 1.679148e-04, 1.675499e-04, 1.671501e-04, 1.666673e-04, 1.660535e-04, 1.652608e-04, 1.642620e-04, 1.630585e-04, 1.616447e-04, 1.600149e-04, 1.581637e-04, 1.561102e-04, 1.538252e-04, 1.512298e-04, 1.482456e-04, 1.447939e-04, 1.408153e-04, 1.364007e-04, 1.316969e-04, 1.268509e-04, 1.220093e-04, 1.172509e-04, 1.125513e-04, 1.079024e-04, 1.032961e-04, 9.872439e-05, 9.420439e-05, 8.976512e-05, 8.541646e-05, 8.116827e-05, 7.703043e-05, 7.300974e-05, 6.911795e-05, 6.537220e-05, 6.178967e-05, 5.838753e-05, 5.517807e-05, 5.215424e-05, 4.930417e-05, 4.661596e-05, 4.407775e-05, 4.168470e-05, 3.943514e-05, 3.732199e-05, 3.533819e-05, 3.347665e-05, 3.172918e-05, 3.008939e-05, 2.855299e-05, 2.711567e-05, 2.577314e-05, 2.452400e-05, 2.335537e-05, 2.224561e-05, 2.117314e-05, 2.011631e-05, 1.906162e-05, 1.801463e-05, 1.698236e-05, 1.597184e-05, 1.499011e-05, 1.403672e-05, 1.311169e-05, 1.222274e-05, 1.137762e-05, 1.058404e-05, 9.845415e-06, 9.159648e-06, 8.526239e-06, 7.944694e-06, 7.414514e-06, 6.936858e-06, 6.507543e-06, 6.118073e-06, 5.759951e-06, 5.424678e-06, 5.107663e-06, 4.808457e-06, 4.524774e-06, 4.254329e-06, 3.994837e-06, 3.743480e-06, 3.499807e-06, 3.265074e-06, 3.040541e-06, 2.827465e-06, 2.625810e-06, 2.434656e-06, 2.253933e-06, 2.083574e-06, 1.923510e-06, 1.773614e-06, 1.633596e-06, 1.503146e-06, 1.381953e-06, 1.269706e-06, 1.166162e-06, 1.070900e-06, 9.833514e-07, 9.029416e-07, 8.290990e-07, 7.613688e-07, 6.994375e-07, 6.429451e-07, 5.915314e-07, 5.448365e-07, 5.025383e-07, 4.642766e-07, 4.296344e-07, 3.981950e-07, 3.695413e-07, 3.433134e-07, 3.193785e-07, 2.976608e-07, 2.780846e-07, 2.605739e-07, 2.449585e-07, 2.310676e-07, 2.188253e-07, 2.081560e-07, 1.989838e-07, 1.911886e-07, 1.846001e-07, 1.790665e-07, 1.744361e-07, 1.705575e-07, 1.673612e-07, 1.646638e-07, 1.621434e-07, 1.594776e-07, 1.563445e-07, 1.525668e-07, 1.482335e-07, 1.434199e-07, 1.382021e-07, 1.326559e-07, 1.266548e-07, 1.203378e-07, 1.141788e-07, 1.086515e-07, 1.042296e-07, 1.012733e-07, 9.943504e-08, 9.812744e-08, 9.676298e-08, 9.475419e-08, 9.178270e-08, 8.811381e-08, 8.403559e-08, 7.983609e-08, 7.580335e-08, 7.210415e-08, 6.857171e-08, 6.499379e-08, 6.115814e-08, 5.685251e-08, 5.191266e-08, 4.658116e-08, 4.125597e-08, 3.633508e-08, 3.221642e-08, 2.911354e-08, 2.683060e-08, 2.515155e-08, 2.386036e-08, 2.274100e-08, 2.175051e-08, 2.090656e-08, 2.008410e-08, 1.915804e-08, 1.800330e-08, 1.650744e-08, 1.474754e-08, 1.288278e-08, 1.107234e-08, 9.475419e-09, 8.161494e-09, 7.068662e-09, 6.159022e-09, 5.394671e-09, 4.737709e-09, 4.184345e-09, 3.740895e-09, 3.384620e-09, 3.092777e-09, 2.842626e-09, 2.620269e-09, 2.421917e-09, 2.239989e-09, 2.066904e-09, 1.895084e-09, 1.718209e-09, 1.535018e-09, 1.345509e-09, 1.149684e-09, 9.475419e-10, 7.327657e-10, 5.116726e-10, 3.032134e-10, 1.263389e-10 ]

def _interp(data, lmin,lmax, l):
    part = (l - lmin)/(lmax - lmin)
    if part<0.0 or part>1.0: return 0.0

    imax = len(data) - 1
    part *= imax
    i0 = int(part)
    i1 = min([i0+1,imax])
    part -= i0
    val0 = data[i0]
    val1 = data[i1]
    return lerp(val0,val1,part)

def sample_ciexyz(l):
    xbar = _interp(_cie_xbar_2deg_data, 360.0,830.0, l)
    ybar = _interp(_cie_ybar_2deg_data, 360.0,830.0, l)
    zbar = _interp(_cie_zbar_2deg_data, 360.0,649.0, l)
    return (xbar,ybar,zbar)

def sample_lrgb_ciexyz(l, sc):
    xbar,ybar,zbar = sample_ciexyz(l)
    xbar,ybar,zbar = xbar*sc,ybar*sc,zbar*sc
    rlin =  3.2406*xbar - 1.5372*ybar - 0.4986*zbar
    glin = -0.9689*xbar + 1.8758*ybar + 0.0415*zbar
    blin =  0.0557*xbar - 0.2040*ybar + 1.0570*zbar
    return (rlin,glin,blin, xbar,ybar,zbar)

def project_to_representable(r,g,b):
    #References:
    #   http://aty.sdsu.edu/explain/optics/rendering.html
    #   https://www.fourmilab.ch/documents/specrend/
    w = -min([0,r,g,b])
    if w > 0.0:
        r += w
        g += w
        b += w
    return (r,g,b)

def gamma(linear):
    if linear <= 0.0031308: return 12.92*linear
    else:                   return 1.055*(linear**(1.0/2.4)) - 0.055

def quantize(c):
    val = rndint(c * 255.0)
    if   val<  0: val=  0
    elif val>255: val=255
    return val
